<!-- Modal -->
<div class="modal fade" id="widgetModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content p-0">
            <div class="widget-wrapper">
                <div id="left-side">
                    <ul>
                        <li class="choose active">
                            <div class="icon active">
                                <svg viewBox="0 0 16 16" class="bi bi-pencil-square" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456l-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                                    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z" />
                                </svg>
                            </div>
                            Edit
                        </li>
                        <li class="wrap">
                            <div class="icon">
                                <svg viewBox="0 0 16 16" class="bi bi-gear-wide-connected" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M8.932.727c-.243-.97-1.62-.97-1.864 0l-.071.286a.96.96 0 0 1-1.622.434l-.205-.211c-.695-.719-1.888-.03-1.613.931l.08.284a.96.96 0 0 1-1.186 1.187l-.284-.081c-.96-.275-1.65.918-.931 1.613l.211.205a.96.96 0 0 1-.434 1.622l-.286.071c-.97.243-.97 1.62 0 1.864l.286.071a.96.96 0 0 1 .434 1.622l-.211.205c-.719.695-.03 1.888.931 1.613l.284-.08a.96.96 0 0 1 1.187 1.187l-.081.283c-.275.96.918 1.65 1.613.931l.205-.211a.96.96 0 0 1 1.622.434l.071.286c.243.97 1.62.97 1.864 0l.071-.286a.96.96 0 0 1 1.622-.434l.205.211c.695.719 1.888.03 1.613-.931l-.08-.284a.96.96 0 0 1 1.187-1.187l.283.081c.96.275 1.65-.918.931-1.613l-.211-.205a.96.96 0 0 1 .434-1.622l.286-.071c.97-.243.97-1.62 0-1.864l-.286-.071a.96.96 0 0 1-.434-1.622l.211-.205c.719-.695.03-1.888-.931-1.613l-.284.08a.96.96 0 0 1-1.187-1.186l.081-.284c.275-.96-.918-1.65-1.613-.931l-.205.211a.96.96 0 0 1-1.622-.434L8.932.727zM8 12.997a4.998 4.998 0 1 0 0-9.995 4.998 4.998 0 0 0 0 9.996z" />
                                    <path fill-rule="evenodd" d="M7.375 8L4.602 4.302l.8-.6L8.25 7.5h4.748v1H8.25L5.4 12.298l-.8-.6L7.376 8z" />
                                </svg>
                            </div>
                            Configuration
                        </li>
                        <li class="pay">
                            <div class="icon">
                                <svg viewBox="0 0 16 16" class="bi bi-card-checklist" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M14.5 3h-13a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h13a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z" />
                                    <path fill-rule="evenodd" d="M7 5.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0zM7 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm-1.496-.854a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0z" />
                                </svg>
                            </div>
                            Types
                        </li>
                        <li class="ship">
                            <div class="icon">
                                <svg viewBox="0 0 16 16" class="bi bi-clipboard-check" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z" />
                                    <path fill-rule="evenodd" d="M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3zm4.354 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z" />
                                </svg>
                            </div>
                            Review
                        </li>
                    </ul>
                </div>
                <div id="border">
                    <div id="line" class="one"></div>
                </div>
                <div id="right-side">
                    <div class="main active" name_attr="main">
                        <h3>Enter title and choose type</h3>
                        <hr />
                        <div class="input-block shadow mt-1 required">
                            <label for="">Title</label>
                            <input type="text" class="form-control">
                        </div>
                        <div class="row category-list required">
                            <input type="hidden" />
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/fluent/64/000000/info.png" type_attr="info" />
                                </label>
                                <br />
                                info
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/fluent/64/000000/combo-chart.png" type_attr="chart" />
                                </label>
                                <br />
                                chart
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/fluent/64/000000/toggle-indeterminate.png" type_attr="toggle"  />
                                </label>
                                <br/>
                                switch/toggle
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/officel/64/000000/light-dimming-10-percent.png" type_attr="dimmer" />
                                </label>
                                <br />
                                dimmer
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/officel/64/000000/blind-automatic-mode.png" type_attr="blinds" />
                                </label>
                                <br />
                                blinds
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/color/64/000000/wallmount-camera.png" type_attr="camera" />
                                </label>
                                <br />
                                camera
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/officel/64/000000/command-line.png" type_attr="command" />
                                </label>
                                <br />
                                custom command
                            </div>

                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/fluent/64/000000/strategy-news.png" type_attr="feed" />
                                </label>
                                <br />
                                news feed
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/cute-clipart/64/000000/calendar.png" type_attr="calendar" />
                                </label>
                                <br />
                                calendar
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/fluent/64/000000/weather.png" type_attr="forecast" />
                                </label>
                                <br />
                                weather forecast
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/officel/64/000000/wind-gauge.png" type_attr="weather" />
                                </label>
                                <br />
                                weather station
                            </div>
                            <div class="col-3">
                                <label>
                                    <img src="https://img.icons8.com/color/64/000000/widescreen-tv.png" type_attr="display" /><br />
                                </label>
                                <br />
                                custom display
                            </div>
                        </div>
                        <div class="row ">
                            <div class="col-12 btn-bottom">
                                <div class="float-right">
                                    <button class="btn btn-primary" onclick="next(this)">Next</button>
                                </div>
                            </div>

                        </div>

                    </div>
                    <div class="info-types" name_attr="info-types">
                        <h3 class="mb-3">Select Type</h3>
                        <hr />
                        <div class="row required">
                            <input type="hidden" />
                            <div class="col-sm-6" style="padding: 0 90px">
                                <div class="flat-card" type_attr="flat">
                                    <div class="card__flipper">
                                        <div class="card__front">
                                            <p class="card__name">Temperature</p>
                                            <p class="card__num">25<br />°C</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="card-grad text-center" type_attr="gradient">
                                    <div class="title">
                                        <i class="fa " aria-hidden="true">
                                            <img height="75" src="/assets/images/1684375.svg" />
                                        </i>
                                        <h2>Temperature</h2>
                                    </div>
                                    <div class="price">
                                        <h4>25<sup>°C</sup></h4>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 widget">
                                <div class="list-group-item" type_attr="doubleLine">
                                    <div class="float-left">
                                        <img height="75" src="/assets/images/1684375.svg" />
                                    </div>
                                    <div class="float-right">
                                        <div class="card-title h3 text-uppercase text-dark">Temperature</div>
                                        <div class="float-right h2 font-weight-bold m-0">25 °C</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 widget">
                                <div class="list-group-item" type_attr="singleLine">
                                    <div class="float-left">
                                        <img height="75" src="/assets/images/1684375.svg" />
                                        <span class="card-title h3 text-uppercase text-dark mt-1">Temperature</span>
                                    </div>
                                    <div class="float-right">

                                        <div class="float-right h2 font-weight-bold m-0 mt-3">25 °C</div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-12 btn-bottom">
                                <div class="float-left">
                                    <button class="btn btn-primary" onclick="back(this)">Back</button>
                                </div>
                                <div class="float-right">
                                    <button class="btn btn-primary" onclick="infoConfigShow(this)">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="info-configuration" name_attr="info-configuration">
                        <h3 class="mb-3">Select device and sensors</h3>
                        <hr />
                        <div class="row">
                            <div class="col-6">
                                <select data-style="bg-white shadow" class="selectpicker w-100">
                                    <option value="0" disabled selected>Select device</option>
                                    <option value="1">Meteo Station</option>
                                </select>
                            </div>
                            <div class="col-6">
                                <select multiple data-style="bg-white shadow" class="selectpicker w-100">
                                    <option value="1">Temperature</option>
                                    <option value="2">Huminity</option>
                                </select>
                            </div>
                        </div>
                        <h3 class="mb-3 pt-4">Titles</h3>
                        <div class="d-flex">
                            <span style="display:inline;" class="select-image-trg">
                                <img src="/assets/images/smart house/018-settings.png" style="width: 3em; cursor: pointer; height: 3em; margin-top: 0.4em;" class="mr-3">
                                <i class="fa fa-pencil-square-o fa-sm" style="vertical-align:bottom; margin-left:-1em; padding-right:1em" aria-hidden="true"></i>
                            </span>
                            <div class="input-block shadow mt-1 mb-2 w-50">
                                <label for="">Title for Temperature</label>
                                <input type="text" class="form-control">
                            </div>
                            <span style="display:inline; margin:auto 0.2em" class="select-color-trg">
                                <span class="h2 mt-3 ml-4">20</span>
                                <i class="fa fa-pencil-square-o fa-sm" aria-hidden="true"></i>
                            </span>
                        </div>
                        <div class="d-flex select-image-trg">
                            <span style="display:inline;">
                                <img src="/assets/images/smart house/018-settings.png" style="width: 3em; cursor: pointer; height: 3em; margin-top: 0.4em;" class="mr-3">
                                <i class="fa fa-pencil-square-o fa-sm" style="vertical-align:bottom; margin-left:-1em; padding-right:1em" aria-hidden="true"></i>
                            </span>
                            <div class="input-block shadow mt-1 mb-2 w-50">
                                <label for="">Title for Huminity</label>
                                <input type="text" class="form-control">
                            </div>
                            <span style="display:inline; margin:auto 0.2em" class="select-color-trg">
                                <span class="h2 mt-3 ml-4">68</span>
                                <i class="fa fa-pencil-square-o fa-sm" aria-hidden="true"></i>
                            </span>
                        </div>
                        <div class="icons-popup">
                            <h2 class="m-2 p-2">Select icon for "Температура" <img id="selectedImage" style="width: 1.5em; cursor: pointer; margin-top: -0.6em; display: none" /></h2>
                            <hr />
                            <script type="text/javascript">
                                var selectImageTarget;
                                var selectColorTarget;

                                document.addEventListener('DOMContentLoaded', function () {
                                    $('.image-list img').on('click', function (el) {
                                        var selectedImage = $("#selectedImage");
                                        var target = $(el.target);

                                        selectedImage.attr("src", target.attr("src"));
                                        selectedImage.show();
                                    });

                                    $('.select-image-trg').on('click', function (el) {
                                        var target = $(el.target);
                                        var selectedImage = $("#selectedImage");
                                        selectImageTarget = (target.siblings("img").first()).length > 0 ?
                                            target.siblings("img").first() : target;

                                        selectedImage.attr("src", target.attr('src'));
                                        selectedImage.show();
                                        $('.icons-popup').addClass('show-icons');

                                    });

                                    $('#applyImage').on('click', function () {
                                        selectImageTarget.attr("src", $("#selectedImage").attr("src"));
                                        $('.icons-popup').removeClass('show-icons');
                                    })


                                    $('.select-color-trg').on('click', function (el) {
                                        var target = $(el.target);
                                        selectColorTarget = (target.siblings("span").first()).length > 0 ?
                                            target.siblings("span").first() : target;
                                        $('.color-popup').addClass('show-color');
                                    });

                                    $('#applyColor').on('click', function () {
                                        selectColorTarget.css("color", $("#setting-title").css("color"));
                                        $('.color-popup').removeClass('show-color');
                                    })
                                });
                            </script>
                            <div class="row image-list" style="overflow-y: scroll; height: 42em;">
                                <div class="col-2"><img src="~/assets/images/smart house/001-mobile phone.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/002-humidity.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/003-home control.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/004-smart trash.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/005-cctv.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/006-smart watch.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/007-fingerprint.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/008-alarm.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/009-voice assistant.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/010-heater.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/011-smart washing machine.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/012-toilet.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/013-kettle.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/014-smarthome.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/015-video doorbell.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/016-smarthome.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/017-water dispenser.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/018-lamp.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/019-heater.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/020-knob.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/021-smart refrigerator.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/022-alarm.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/023-voice assistant.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/024-charger.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/025-gps.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/026-air conditioner.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/027-smart tv.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/028-dishwasher.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/029-app.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/030-key car.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/031-microwave.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/032-airpods.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/033-coffee machine.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/034-ebook.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/035-socket.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/036-smart scale.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/037-air fryer.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/038-smartphone.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/039-garage.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/040-remote control.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/041-wifi.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/042-gate.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/043-robot vacuum cleaner.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/044-cctv.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/045-voice assistant.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/046-stove.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/047-smarthome.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/048-mouse.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/049-wireless router.png" /></div>
                                <div class="col-2"><img src="~/assets/images/smart house/050-thermostat.png" /></div>
                            </div>
                            <div class="float-right">
                                <button class="m-4 btn btn-danger" onclick="$('.icons-popup').removeClass('show-icons')">Cancel</button>
                                <button class="m-4 btn btn-success" id="applyImage">Apply</button>
                            </div>
                        </div>
                        <div class="col-12 btn-bottom">
                            <div class="float-left">
                                <button class="btn btn-primary" onclick="back(this)">Back</button>
                            </div>
                            <div class="float-right">
                                <button class="btn btn-primary" onclick="next(this)">Next</button>
                            </div>
                        </div>
                        <div class="color-popup">
                            <h2>Edit value</h2>
                            <hr />
                            <h3>Format</h3>
                            <div class="d-flex mb-4">
                                <div class="input-block shadow mt-1 mb-2 w-25">
                                    <label for="">Symbol before</label>
                                    <input type="text" class="form-control">
                                </div>
                                <span class="h4 m-3" id="setting-title">68</span>
                                <div class="input-block shadow mt-1 mb-2 w-25">
                                    <label for="">Symbol after</label>
                                    <input type="text" class="form-control">
                                </div>
                                <select multiple data-style="bg-white shadow" class="selectpicker w-25 mt-1 ml-5">
                                    <option value="1">Decimal 0.00</option>
                                    <option value="2">Datetime dd-mm-yyyy</option>
                                </select>
                            </div>
                            <h3>Color</h3>
                            <div class="d-flex mt-2">
                                <svg id="donut-chart"></svg>
                                @await Html.PartialAsync("_ColorPicker")
                                <ul class="range" style="display: none">
                                    <li class="header">RANGE:</li>
                                    <li style="color: rgb(13, 71, 161);">MIN .. -05</li>
                                    <li style="color: rgb(33, 150, 243);">-05 .. 0</li>
                                    <li style="color: #62c5ef;"> 0 ..  15</li>
                                    <li class="active" style="color: #ffa726;"> 15 .. 27</li>
                                    <li style="color: #ef5350;"> 27 .. MAX</li>
                                </ul>
                            </div>
                            <div class="float-right">
                                <button class="m-4 btn btn-danger" onclick="$('.color-popup').removeClass('show-color')">Cancel</button>
                                <button class="m-4 btn btn-success" id="applyColor">Apply</button>
                            </div>
                        </div>
                    </div>
                    <div class="to-be-implemented" name_attr="to-be-implemented">
                        <h1><center>To be implemented soon...</center></h1>
                        <div class="row">
                            <div class="col-12 btn-bottom">
                                <div class="float-left">
                                    <button class="btn btn-primary" onclick="back(this)">Back</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var widgetRequest = {};
    var nextPage = [];
    var prevPage = [];
    var pageIndex = 0;
    var currentType = '';

    function next(target) {
        var from = $(target).closest('.active').attr('name_attr');
        var requires = $("." + from + " .required");
        var emptyFields = 0;

        requires.each(function () {
            var input = $('input', this);

            if (input && input.val() == "") {
                $(this).addClass("vibration");
                emptyFields++;
            }
        });

        setTimeout(function () {
            $("." + from + " .required").removeClass("vibration");
        }, 1500);

        if (emptyFields == 0) {
            $('#right-side .' + from).removeClass("active");
            $('#right-side .' + nextPage[pageIndex]).addClass("active");
            pageIndex++;
            return true;
        }

        return false;
    }

    function back(target) {
        var from = $(target).closest('.active').attr('name_attr');
        $('#right-side .' + from).removeClass("active");
        $('#right-side .' + prevPage[pageIndex-1]).addClass("active");
        pageIndex--;
    }

    function clearForm(type) {
        if (currentType != type) {
            $('.category-list label').parent().css('opacity', '1');
            $('.info-types div.required>div').css('opacity', '1');

            $('.category-list input').val('');
            $('.info-types div.required input').val('');

            nextPage = [];
            prevPage = [];
            prevPage.push('main');
            currentType = type;
        }
    }

    function infoConfigShow(target) {
        if (next(target) && pageIndex == prevPage.length) {
            prevPage.push('info-configuration');
            nextPage.push('to-be-implemented');
        }
    };

    document.addEventListener('DOMContentLoaded', function () {
        $('.carousel').carousel();

        $('.category-list img').on('click', function () {
            var type = $(this).attr('type_attr');
            clearForm(type);

            $('.category-list label').parent().css('opacity', '0.3');
            $(this).parent().parent().css('opacity', '1');
            $('.category-list input').val("1");

            switch (type) {
                case 'info':
                    nextPage.push('info-types');
                    widgetRequest.url = 'info'
                    break;
                default:
                    nextPage.push('to-be-implemented');
            }

        });

        $('.info-types .flat-card, .info-types .list-group-item, .info-types .card-grad').on('click', function () {
            $('.info-types div.required>div').css('opacity', '0.3');
            $(this).parent().css('opacity', '1');
            $('.info-types div.required input').val('1');

            prevPage.push('info-types');
            nextPage.push('info-configuration');

            widgetRequest.data = {
                type: $(this).attr('type_attr')
            };
        });

        $('.widget-wrapper').find('.form-control').each(function () {
            var targetItem = $(this).parent();
            if ($(this).val()) {
                $(targetItem).find('label').css({
                    'top': '10px',
                    'fontSize': '18px'
                });
            }
        });

        $('.widget-wrapper').find('.form-control').focus(function () {
            $(this).parent('.input-block').addClass('focus');
            $(this).parent().find('label').animate({
                'top': '1em',
                'fontSize': '1em'
            }, 300);
        });

        $('.widget-wrapper').find('.form-control').blur(function () {
            if ($(this).val().length == 0) {
                $(this).parent('.input-block').removeClass('focus');
                $(this).parent().find('label').animate({
                    'top': '1.3em',
                    'fontSize': '1.2em'
                }, 300);
            }
        })

        mainPie("donut-chart");
        $('.selectpicker').selectpicker();
    });
   
    function mainPie(id) {
        var seedData = [{"value": 25}, {"value": 25}, {"value": 25}, {"value": 25}, {"value": 25}, {"value": 25 }, {"value": 25 }, {"value": 25 }, {"value": 25}, {"value": 25}, {"value": 25}, {"value": 25        }, {"value": 25}, {"value": 25}, {"value": 25}, {"value": 25}, {"value": 25}, {"value": 25}];

        var width = 300, height = 300, radius = Math.min(width, height) / 2;

        var colour = function (index) {
            var items = ['rgb(239, 83, 80)', 'rgb(236, 64, 122)', 'rgb(171, 71, 188)', 'rgb(126, 87, 194)', 'rgb(92, 107, 192)', 'rgb(66, 165, 245)', 'rgb(41, 182, 246)', 'rgb(38, 198, 218)', 'rgb(38, 166, 154)', 'rgb(102, 187, 106)', 'rgb(156, 204, 101)', 'rgb(212, 225, 87)',
                'rgb(255, 238, 88)', 'rgb(255, 202, 40)', 'rgb(255, 167, 38)', 'rgb(255, 112, 67)', 'rgb(141, 110, 99)', 'rgb(189, 189, 189)', 'rgb(120, 144, 156)'];

            return items[index];
        }

        var arc = d3.arc()
            .innerRadius(radius - 70)
            .outerRadius(radius - 10);

        var pie = d3.pie()
            .value(function (d) { return d["value"]; })
            .sort(null);

        var svg = d3.select("#" + id)
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", "translate(" + radius + "," + radius + ")");

        svg.append("circle")
            .attr("cx", 0)
            .attr("cy", 0)
            .attr("r", 100)
            .attr("fill", "#fff");

        var g = svg.selectAll(".arc")
            .data(pie(seedData))
            .enter().append("g")
            .attr("class", "arc")

            .on("click", function (d, i, el) {
                $.each(el, function (index, value) {
                    $(value)
                        .attr("fill", "none")
                        .attr("stroke", colour(index))
                        .attr("stroke-width", "0");
                });

                $(el[i]).attr("stroke-width", "15");
                $("#setting-title").css("color", $(el[i]).attr("stroke"));
                showColorPalette(i);
            });

        function showColorPalette(i) {
            $(".color-palette").hide();
            var colorId = "#color-" + i;
            $(colorId).show();
        }

        g.append("path")
            .attr("d", arc)
            .attr("fill", function (d, i) {
                return colour(i);
            });

        return g;
    }   
</script>